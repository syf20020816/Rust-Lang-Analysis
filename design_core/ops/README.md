# Ops Design

## ğŸ‘Arith Design

Arithæ˜¯å„ç±»è¿ç®—ç¬¦å·çš„è®¾è®¡(`+,-,*,/,%`)

æ•´ä½“ä¸Šæ¥çœ‹å•ä¸ªè¿ç®—ç¬¦ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š

1. Arith Traitï¼ˆè¿ç®—ç¬¦å®ç°çš„Traitï¼‰
2. Arith Macroï¼ˆç”Ÿæˆç±»å‹è¿ç®—ç¬¦çš„å®ï¼‰

é€šè¿‡`Arith Macro`å°†ç»Ÿä¸€çš„ç”Ÿæˆ2ç±»`impl Trait for Type`

1. `impl const Trait for Type`
2. `impl Trait for Type`

åœ¨Rustä¸­ï¼Œ`impl MyTrait`å’Œ`impl const MyTrait`ä¹‹é—´æœ‰ä¸€äº›åŒºåˆ«ã€‚

1. åŠŸèƒ½ç‰¹æ€§ï¼š`impl MyTrait`ç”¨äºå®ç°ä¸€ä¸ªæ™®é€šçš„traitï¼Œè¯¥traitå¯ä»¥åŒ…å«ä»»æ„çš„æ–¹æ³•å’Œå…³è”ç±»å‹ã€‚è€Œ`impl const MyTrait`ç”¨äºå®ç°ä¸€ä¸ªç‰¹æ®Šçš„traitï¼Œè¯¥traitåªèƒ½åŒ…å«å…·æœ‰`const`ä¿®é¥°ç¬¦çš„æ–¹æ³•ã€‚
2. æ–¹æ³•è°ƒç”¨ï¼šå¯¹äº`impl MyTrait`å®ç°çš„traitï¼Œå…¶æ–¹æ³•å¯ä»¥é€šè¿‡å®ä¾‹å¯¹è±¡è¿›è¡Œè°ƒç”¨ï¼Œå³å¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†å‘ã€‚è€Œ`impl const MyTrait`å®ç°çš„traitä¸­çš„æ–¹æ³•åªèƒ½é€šè¿‡ç±»å‹åç›´æ¥è°ƒç”¨ï¼Œå³ä½¿ç”¨é™æ€åˆ†å‘ã€‚
3. ç‰¹åŒ–å¸¸é‡ï¼š`impl MyTrait`å¯ä»¥åœ¨å®ç°ä¸­ä½¿ç”¨ç‰¹å®šçš„å¸¸é‡å€¼ã€‚å¯¹äº`impl const MyTrait`ï¼Œå®ƒå…è®¸åœ¨traitçš„æ–¹æ³•ä¸­ä½¿ç”¨constå¸¸é‡ï¼Œå¹¶ä¿è¯åœ¨ç¼–è¯‘æ—¶è¿›è¡Œè®¡ç®—ã€‚è¿™å¯ä»¥ç”¨äºåœ¨ç¼–è¯‘æœŸé—´ä¼˜åŒ–ä»£ç ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`impl const`æ˜¯Rust 1.50ç‰ˆæœ¬å¼•å…¥çš„æ–°åŠŸèƒ½ï¼Œå› æ­¤å¦‚æœä½ ä½¿ç”¨è¾ƒæ—©çš„Rustç‰ˆæœ¬ï¼Œå¯èƒ½ä¸æ”¯æŒ`impl const`ã€‚

ç„¶åå°±æ˜¯å†…éƒ¨çš„å¯¹æ–¹æ³•çš„å®ç°åŒæ ·åˆ†ä¸º3ç±»(å®ç°äº`core/src/internal_macros.rs`)ï¼š

1. `fn $method(self, rhs: $u)->Self::Output`
2. `fn $method(self, rhs: &$u)->Self::Output`
3. `fn $method(self, rhs: &$u)->Self::Output`

è¿™æ˜¯å› ä¸ºéœ€è¦å…³æ³¨æ•°æ®æ‰€æœ‰æƒï¼Œä½†æ˜¯æœ€ç»ˆè¿™ä¸‰ç§å®ç°éƒ½ä¼šå»è°ƒç”¨`core/src/ops/arith.rs`ä¸­çš„åŸå§‹æ–¹æ³•ï¼Œä¸»è¦è¿˜æ˜¯ä¸ºäº†å…¼å®¹ï¼ˆè¿™ä¸ªå…¼å®¹çš„å†™æ³•æ˜¯å¾ˆé‡è¦çš„ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­å¾ˆå€¼å¾—å€Ÿé‰´ï¼‰

åŸå§‹æ–¹æ³•ä»¥`arith::Add`ä¸ºä¾‹ï¼š

```rust
        impl const Add for $t{
            type Output = $t;

            fn add(self, rhs:$t) -> $t {
                self + rhs
            }
        }
```

